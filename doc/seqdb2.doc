====================
Seqdb2 Documentation
====================

:Author: Alex Nolley
:Date: October 3, 2008

.. contents:

Introduction
============

Seqdb2 is a database generation and querying package made to be used with gene
sequences generated by Solexa machines, namely FASTA and FASTQ formats. Values
such as sequence name, sequence description and the sequence itself can be
retrieved from these databases. Because it is written in C++ with a Pyrex
wrapper built around it, the building and querying is much faster than a
strictly Python one.

Getting Going
=============

The following software packages are required to build and run seqdb2:

* Python 2.4 or newer
* gcc
* make
* cmake
* pyrex

If you want to run the included tests after building, you will need to install
nose as well

Downloading
-----------

You will need git to download a copy from the public git repository:
    git-clone git://iorich.caltech.edu/git/public/seqdb2

Installing
----------

Assuming you have already downloaded the package, this is how you build it:

1. cd into the directory:
    cd seqdb2/
2. generate the makefile with cmake:
    cmake .
3. build the package:
    make
4. run the optional tests:
    nosetests

Quick-Start
===========

Building the databases
----------------------

At the moment there is no Python wrapper for the C++ database builders, so
they are run from the command line. I will use the included FASTA file, 
/tests/test.fa and the included FASTQ file, tests/test.fastq for references.

1. cd into the bin/ subdirectory
    cd bin/

2. build a seqdb2 database from each file:
    ./fadbm ../tests/test.fa

    ./fqdbm ../tests/test.fastq

Notice that a different database writer was used for the different type of
database. Until a wrapper is built around these modules, the user will have to
specify which one to use. The resulting databases are written to the same
directory that the input files were pulled from. The FASTA and FASTQ databases
are named tests/test.fa_seqdb2 and tests/test.fastq_seqdb2 respectivly. There 
are also .idx files generated in the same directory.

Querying the databases
----------------------

Now that the databases are generated. Querying them is simple and can be done
from the Pyrex module

1. cd into the python/ subdirectory
    cd python/

2. start the python interpreter
    python

3. import the seqdb2 module
    >>> import seqdb2

4. load the databases
    >>> fadb = seqdb2.SeqDB2('../tests/test.fa_seqdb2')
    >>> fqdb = seqdb2.SeqDB2('../tests/test.fastq_seqdb2')

5. show the kinds of data retrievable from the databases
    >>> fadb.fields
    ['description', 'name', 'sequence']
    >>> fqdb.fields
    ['accuracy', 'name', 'sequence']

6. length of the databases are easily found
    >>> print len(fadb)
    22
    >>> print len(fqdb)
    49

7. retrieve a name from a specific entry in each database:
    >>> print fadb[0].name
    ENSMICT00000012722
    >>> print fqdb[0].name
    HWI-EAS_4_PE-FC20GCB:1:1:62:922/1

You can also iterate through the databases as if they were a list of lists of
strings with:

for k in fqdb:
    print k.name
    
..
    Local Variables:
    mode: rst
    mode: outline-minor
    End:

